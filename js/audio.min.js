!function(){"use strict";function ba(){o=document.createElement("canvas"),p=o.getContext("2d"),q=document.createElement("canvas"),r=q.getContext("2d"),s=document.createElement("canvas"),t=s.getContext("2d"),window.addEventListener("resize",ra,!1),ra(),f=document.querySelector("audio"),g=wa(f),ca(),xa(f,b),v=_,N=[];for(var a=0;a<100;a++){var c=new Da;N.push(c)}da()}function ca(){document.querySelector("#trackSelect").onchange=function(a){xa(f,a.target.value)},document.querySelector("#colorSelect").onchange=function(a){v="gradient"==a.target.value?_:a.target.value},document.querySelector("#fsButton").onclick=function(){ya(k)},document.querySelector("#radiusSlider").onchange=function(a){document.querySelector("#radiusSliderResults").innerHTML=a.target.value,w=200,w*=a.target.value},document.querySelector("#reverbSlider").onchange=function(a){document.querySelector("#reverbSliderResults").innerHTML=a.target.value+"s",H=a.target.value},document.querySelector("#audioForm").onclick=function(a){"frequency"==a.target.value?(F=!0,G=!1):"waveform"==a.target.value&&(F=!1,G=!0)},document.getElementById("clear").onclick=function(){ua()},document.getElementById("save").onclick=function(){Ca()},pa()}function da(){requestAnimationFrame(da),I.delayTime.value=H,u=new Uint8Array(a/2),F?g.getByteFrequencyData(u):G&&g.getByteTimeDomainData(u),ta(),sa(h),l.fillStyle=l.strokeStyle=n.fillStyle=n.strokeStyle=p.fillStyle=p.strokeStyle=r.fillStyle=r.strokeStyle=t.fillStyle=v,l.globalAlpha=n.globalAlpha=p.globalAlpha=r.globalAlpha=aa;for(var b=0;b<u.length;b++){if(x&&ma(b,u[b],u.length),z){var c=w/200;na(b,u[b],u.length,c)}if(y){var c=w/200;fa(b,u[b],u.length,c),ga(b,u[b],u.length,c)}if(B){var d=u[b]/255;L=w*d,n.lineWidth=L,m.onmousedown=ha,m.onmousemove=ia,m.onmouseup=ja,m.onmouseout=ka}}ea(),C&&la()}function ea(){y&&(l.drawImage(o,0,0),l.drawImage(q,0,0))}function fa(a,b,c,d){var e=h/c;0==a?(p.beginPath(),p.moveTo(e*a,i/2)):a<c-1?(p.lineTo(e*a,i/2-b*d),p.stroke()):(p.lineTo(h,i/2),p.stroke(),p.closePath())}function ga(a,b,c,d){var e=h/c;0==a?(r.beginPath(),r.moveTo(e*a,i/2)):a<c-1?(r.lineTo(e*a,i-(i/2-b*d)),r.stroke()):(r.lineTo(h,i/2),r.stroke(),r.closePath())}function ha(a){K=!0,n.lineCap="round";var b=za(a);n.beginPath(),n.moveTo(b.x,b.y)}function ia(a){var b=za(a);P.x=b.x,P.y=b.y,K&&B&&(n.lineTo(b.x,b.y),n.stroke())}function ja(a){K=!1,n.closePath()}function ka(a){K=!1,n.closePath()}function la(){if(z||y||x||A){for(var a=l.getImageData(0,0,k.width,k.height),b=a.data,c=b.length,e=(a.width,0);e<c;e+=4){var f=b[e],g=b[e+1],h=b[e+2];b[e]=255-f,b[e+1]=255-g,b[e+2]=255-h}l.putImageData(a,0,0)}}function ma(a,b,c){var d=1,e=200,g=h/c;l.fillRect(a*(g+d),i/2-b,g,e),l.fillRect(h-a*(g+d),i/2-b,g,e)}function na(a,b,c,d){l.lineWidth=3;var e=0,j=h/c;l.beginPath(),l.moveTo(a*(e+j),i/2-b*d),l.lineTo(a*(e+j),i/2+b*d),l.closePath(),l.stroke()}function pa(){var a=document.getElementById("showRect"),b=document.getElementById("showBars"),c=document.getElementById("showLines"),d=document.getElementById("paint"),e=document.getElementById("invert");a.onchange=function(a){x=!!a.target.checked},b.onchange=function(a){z=!!a.target.checked},c.onchange=function(a){y=!!a.target.checked},d.onchange=function(a){var b=document.querySelector(".paint");a.target.checked?(B=!0,b.style.display="block"):(B=!1,b.style.display="none")},e.onchange=function(a){C=!!a.target.checked}}function qa(a,b){return Math.random()*(b-a)+a}function ra(){window.innerWidth>=960?(M=300,j=!1):(M=0,j=!0),i=window.innerHeight,h=window.innerWidth-M,k.width=h,k.height=i,m.width=k.width,m.height=k.height,o.width=h,o.height=i,q.width=h,q.height=i,s.width=h,s.height=i,sa(k.width)}function sa(a){var b=l.createLinearGradient(0,0,a,0);b.addColorStop(0,Q),b.addColorStop(1/6,R),b.addColorStop(2/6,S),b.addColorStop(.5,T),b.addColorStop(4/6,U),b.addColorStop(5/6,V),b.addColorStop(1,W),_=b}function ta(){l.clearRect(0,0,h,i),p.clearRect(0,0,h,i),r.clearRect(0,0,h,i)}function ua(){n.clearRect(0,0,h,i)}function wa(b){var c,d,e;return c=new(window.AudioContext||window.webkitAudioContext),d=c.createAnalyser(),d.fftSize=a,e=c.createMediaElementSource(b),I=c.createDelay(),I.delayTime.value=H,e.connect(I),I.connect(d),d.connect(c.destination),d}function xa(a,b){a.src=b,a.play(),a.volume=.2,document.querySelector("#status").innerHTML=b}function ya(a){a.requestFullscreen?a.requestFullscreen():a.mozRequestFullscreen?a.mozRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}function za(a){var b={};return b.x=a.pageX-a.target.offsetLeft,b.y=a.pageY-a.target.offsetTop,b}function Ca(){var a=m.toDataURL(),b="canvasImage",c="left=0,top=0,width="+k.width+",height="+k.height+",toolbar=0,resizable=0",d=window.open(a,b,c);d.resizeTo(k.width,k.height)}function Da(){function b(){a.position.x=h*Math.random(),a.position.y=Math.random()*-10,a.scale=qa(1,10),a.gravity=2*Math.random()}var a=this;!function(){a.position={},b()}(),a.draw=function(){a.position.y>=i&&b();var c=w/200;a.position.y+=a.gravity,t.beginPath(),t.arc(a.position.x,a.position.y,a.scale*c,0,2*Math.PI,!1),t.fill(),t.closePath()}}var f,g,h,i,j,o,p,q,r,s,t,u,v,I,L,M,N,_,a=256,b="media/Toca Madera.mp3",k=document.querySelector("#canvas"),l=k.getContext("2d"),m=document.querySelector("#topCanvas"),n=m.getContext("2d"),w=200,x=!1,y=!1,z=!0,A=!1,B=!1,C=!1,F=!0,G=!1,H=.5,K=!1,P={},Q="#e74c3c",R="#F66B34",S="#F2D639",T="#2E9F82",U="#80FFDB",V="#4AA0D5",W="#5480f1",aa=.8;window.addEventListener("load",ba)}();
